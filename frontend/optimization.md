# Optimization
프론트엔드는 사용자에게 보여지는 곳을 담당하기 때문에 무엇보다

최적화가 중요하다 사용자는 몇초간 기다리는 것을 제일 싫어한다

다룰 내용은 다음과 같다

- 번들 용량 최소화하기
- DOM 렌더링 최적화
- 비동기 작업 최적화
- 검색 엔진 최적화
- 브라우저 하위 호환
- 기타 최적화

### 1. 번들 용량 최소화
프론트엔드 개발에서 기본적인 부분이다

1 - 컴포넌트, 페이지 단위로 css, js, 등의 코드를 분리하는 code splitting
2 - Image Sprite(비추천)나 svg 등 최적화된 이미지 리소스 사용
3 - minify로 불필요한 공백, 줄바꿈, 주석 등을 제거해서 css, js를 압축
4 - 오픈소스 사용 시 번들 사이즈 고려하기
5 - 웹서버에서 GZip 사용
6 - three shaking 사용해서 빌드 과정에서 사용하지 않는 코드 제거하기
7 - CDN 사용과 브라우저에서 리소스 caching하기 - 엄밀하게 용량을 줄이는 작업은 아닙니다만, 다운로드와 밀접한 관계가 있습니다.

#### Code Spliting
번들링은 훌륭하지만 앱이 커짐에 따라 번들도 커진다

특히 큰 third-party 라이브러리를 포함하는 경우, 번들에 포함된 코드를 주의깊게 확인해야

실수로 커진 앱으로 인해 로드시간이 오래 걸리는 문제를 방지 한다

모든 페이지에 필요한 코드가 아닌데 처음부터 다 불러오게 된다면 사용자 경험에 좋지 않게 된다

코드스플리팅은 한 번에 모든 코드를 불러오는 것이 아닌 나눠서 불러옴으로 이러한 문제를 해결한다

##### 동적 import 구문을 이용
```js
import { add } from './math';

console.log(add(16, 26));
```
동적 import를 이용하면 위의 코드를 아래와 같이 바꿀 수 있다
```js
import("./math").then(math => {
  console.log(math.add(16, 26));
});
```
dynamic import는 현재 js표준은 아니고 제안단계라고 한다

하지만 빠른 시일 내로 표준이 될 것이 예상된다고 함!

Babel을 사용할 때는 Babel 이 dynamic import 구문을 분석하게 하기위해서

`babel-plugin-syntax-dynamic-import` 플러그인이 필요하다!

##### React.lazy와 suspense
다이나믹 임포트를 사용해서 리액트 컴포넌트를 불러올 수 있음

suspense는 동적으로 새로 번들을 가져오기 전에 보여줄 컴포넌트를 등록해주는 역할을 한다

둘 다 SSR(서버사이드렌더링)에는 사용할 수 없어 SSR을 통한 경우에는 LoadableComponents를 이용해야 한다고 한다

#### GZip이란?
우선 gzip이란 파일 압축에 쓰이는 응용 소프트웨어로 GNU zip의 준말이다

GZip은 서버 요청에 대한 response를 빠르게 client에 전달하기 위하여서 생긴 방법이다

사용한 것과 안 한 것과 똑같은 프로세스지만 추가되는 것이 있다

Request에 대하여 Response를 보낼 때 내용을 압축해서 보내는 것이다

그렇기 때문에 보내는 파일의 크기가 작아져서 훨씬 더 빠른 응답속도를 가질 수 있다

#### GZip이 무조건 좋은가?
Gzip을 성능향상이 된다고 해서 무조건 적용하는게 좋을까?

그렇지는 않다 Gzip을 압축하고 푸는데도 서버와 웹브라우저에 약간의 CPU가 쓰이게 된다

그래서 통상적으로 1kb ~ 2kb 이하는 Gzip을 압축하지 않는것이 좋다

압축해서 얻는 효과보다 압축을 푸는 리소스가 더 크기 때문이다

또한 바이러니파일이나 이미지파일등은 지집압축을 해도 효과를 볼 수 없다

웹 성능에서 돔과 더불어 가장 큰 성능 저하의 원인이지만 개선을 위해서는 해상도변경이나 캐싱을 적용하는편이 더 좋다


## Reference
- https://velog.io/@ashnamuh
- https://vnthf.github.io/blog/Front-Gzip%EC%97%90-%EA%B4%80%ED%95%98%EC%97%AC/
- https://velog.io/@odini